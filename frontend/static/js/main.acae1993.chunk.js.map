{"version":3,"sources":["useInterval.js","useOnline.js","App.js","reportWebVitals.js","index.js"],"names":["useInterval","callback","delay","savedCallback","useRef","useEffect","current","id","setInterval","clearInterval","require","useState","useOnline","navigator","onLine","onlineStatus","setOnlineStatus","goOnline","goOffline","window","addEventListener","removeEventListener","timeDisplayOptions","hour","minute","timeZone","hour12","getCurrentTime","displayOptions","date","Date","Intl","DateTimeFormat","format","stopId","URL","location","searchParams","get","JustifiedBusTime","props","number","busTime","due","spacing","length","shortSpace","repeat","longSpace","justifiedValue","className","chars","Presets","ALPHANUM","padMode","value","DataWrapper","styled","div","css","gap","IconWrapper","width","rotation","visible","DataDisplay","span","OfflineWarning","aside","Wind","speed","bearing","viewBox","xmlns","d","fill","Weather","temperature","toFixed","forecast","toLowerCase","includes","fillRule","clipRule","getBus","stop","a","fetch","origin","then","res","json","catch","result","getWeather","App","React","busTimetable","setBusTimetable","currentTime","setCurrentTime","currentWeather","setCurrentWeather","data","buses","map","bus","windSpeed","windBearing","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.acae1993.chunk.js","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\n\n\nconst useInterval = (callback, delay) => {\n  const savedCallback = useRef();\n\n  // Remember the latest callback.\n  useEffect(() => {\n    savedCallback.current = callback;\n  }, [callback]);\n\n  // Set up the interval.\n  useEffect(() => {\n    function tick() {\n      savedCallback.current();\n    }\n    if (delay !== null) {\n      let id = setInterval(tick, delay);\n      return () => clearInterval(id);\n    }\n  }, [delay]);\n}\n\nexport default useInterval;","const { useState, useEffect } = require(\"react\");\n\nconst getOnlineStatus = () => {\n  return typeof navigator !== \"undefined\" &&\n    typeof navigator.onLine === \"boolean\"\n    ? navigator.onLine\n    : true;\n}\n\nconst useOnline = () => {\n  const [onlineStatus, setOnlineStatus] = useState(getOnlineStatus());\n\n  const goOnline = () => setOnlineStatus(true);\n\n  const goOffline = () => setOnlineStatus(false);\n\n  useEffect(() => {\n    window.addEventListener(\"online\", goOnline);\n    window.addEventListener(\"offline\", goOffline);\n\n    return () => {\n      window.removeEventListener(\"online\", goOnline);\n      window.removeEventListener(\"offline\", goOffline);\n    };\n  }, []);\n  return onlineStatus;\n}\n\nexport default useOnline;","import * as React from \"react\";\nimport { FlapDisplay, Presets } from \"react-split-flap-effect\";\nimport styled, {css } from \"styled-components\";\nimport useInterval from \"./useInterval\";\nimport useOnline from \"./useOnline\";\nimport \"./style.css\"\n\nconst timeDisplayOptions = {\n  hour: \"numeric\",\n  minute: \"numeric\",\n  timeZone: \"Europe/London\",\n  hour12: true,\n}\n\nconst getCurrentTime = displayOptions => {\n  const date = new Date();\n  return new Intl.DateTimeFormat(\"en-GB\", displayOptions).format(date);\n}\n\nconst stopId = new URL(window.location).searchParams.get(\"stop\");\n\nconst App = () => {\n  const [busTimetable, setBusTimetable] = React.useState({'buses':[]})\n  const [currentTime, setCurrentTime] = React.useState(getCurrentTime(timeDisplayOptions))\n  const [currentWeather, setCurrentWeather] = React.useState({})\n  const onlineStatus = useOnline();\n  React.useEffect(()=>{\n    if (onlineStatus) {\n      getBus(stopId).then(data=>setBusTimetable(data))\n      getWeather(stopId).then(data=>setCurrentWeather(data))\n  }\n  }, [onlineStatus])\n  useInterval(()=> {\n    getBus(stopId).then(data=>setBusTimetable(data))\n  }, 15000)\n  useInterval(() => {\n    getWeather(stopId).then((data) => setCurrentWeather(data));\n  }, 1800000);\n  useInterval(()=> {\n    setCurrentTime(getCurrentTime(timeDisplayOptions))\n  }, 1000)\n  if (stopId) {\n  return (\n    <>\n    <OfflineWarning visible={!onlineStatus}>OFFLINE</OfflineWarning>\n    <main>\n      <FlapDisplay\n        className=\"M\"\n        chars={Presets.ALPHANUM}\n        padMode=\"start\"\n        length={8}\n        value={currentTime}\n      />\n      <div className=\"times\">\n        {busTimetable.buses.map((bus) => (\n          <JustifiedBusTime length={18} busTime={bus} />\n        ))}\n      </div>\n      <DataWrapper className=\"weather\" gap=\"5vw\">\n          <Wind speed={currentWeather.windSpeed || 0} bearing={currentWeather.windBearing || 0} width=\"2.5vw\" />\n          <Weather forecast={currentWeather.forecast || \"\"} temperature={currentWeather.temperature || 0} width=\"2.5vw\" />\n      </DataWrapper>\n    </main>\n    </>\n  );\n  }\n  else {\n    return(<main>\n      <FlapDisplay className=\"XL\" chars={Presets.ALPHANUM} length={20} value=\"No stop provided\" />\n    </main>)\n  }\n}\n\nconst JustifiedBusTime = props => {\n  const number = props.busTime.number;\n  const due = props.busTime.due;\n  const spacing = (props.length) - (number.length + due.length);\n  const shortSpace = (\" \").repeat(4)\n  const longSpace = (\" \").repeat(spacing-shortSpace.length);\n  const justifiedValue = `${number}${shortSpace}${longSpace}${due}`;\n  return (\n    <FlapDisplay className=\"XL\" chars={Presets.ALPHANUM} padMode=\"start\" length={props.length} value={justifiedValue} />\n  )\n}\n\nconst DataWrapper = styled.div(props=>css`\n  display: flex;\n  flex-flow: row wrap;\n  justify-content: center;\n  align-items: center;\n  > * + * {\n    margin-left: ${props.gap};\n  }\n`)\n\nconst IconWrapper = styled.div(props=>css`\n  width: ${props.width || \"100%\"};\n  transform: rotate(${props.rotation || 0}deg);\n  transition: 1s ease;\n  opacity: ${props.visible ? 1 : 0};\n  > * {\n    width: 100%;\n    height: 100%;\n    transition: all 1s ease;\n  }\n`)\n\nconst DataDisplay = styled.span(props=>css`\n  color: #ffffff;\n  font-size: 2.5vw;\n`)\n\nconst OfflineWarning = styled.aside(\n  (props) => css`\n    color: #dc0051;\n    font-size: 4vw;\n    position: fixed;\n    transform: translate(-50%, 50%);\n    left: 50%;\n    top: 25%;\n    opacity: ${props.visible ? 1 : 0};\n    pointer-events: none;\n    transition: all 1s ease;\n    z-index: 9999999;\n  `\n);\n\n\nconst Wind = props => {\n  return (\n    <DataWrapper gap=\"1vw\">\n      <DataDisplay>{props.speed}mph</DataDisplay>\n      <IconWrapper visible={true} width={props.width} rotation={props.bearing}>\n        <svg viewBox=\"0 0 16 16\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path\n            d=\"M8.35355 0.146447C8.15829 -0.0488155 7.84171 -0.0488155 7.64645 0.146447L4.46447 3.32843C4.2692 3.52369 4.2692 3.84027 4.46447 4.03553C4.65973 4.2308 4.97631 4.2308 5.17157 4.03553L8 1.20711L10.8284 4.03553C11.0237 4.2308 11.3403 4.2308 11.5355 4.03553C11.7308 3.84027 11.7308 3.52369 11.5355 3.32843L8.35355 0.146447ZM7.5 15.5C7.5 15.7761 7.72386 16 8 16C8.27614 16 8.5 15.7761 8.5 15.5H7.5ZM7.5 0.5V15.5H8.5V0.5H7.5Z\"\n            fill=\"white\"\n          />\n        </svg>\n      </IconWrapper>\n    </DataWrapper>\n  );\n}\n\nconst Weather = props => {\n  return (\n    <DataWrapper gap=\"1vw\">\n      <DataDisplay>{props.temperature.toFixed(1)}Â°C</DataDisplay>\n      <IconWrapper visible={props.forecast.toLowerCase().includes(\"rain\")} width={props.width}>\n        <svg\n          viewBox=\"0 0 16 16\"\n          fill=\"none\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n        >\n          <path\n            fillRule=\"evenodd\"\n            clipRule=\"evenodd\"\n            d=\"M11 8.71682C10.7239 8.71682 10.5 8.48676 10.5 8.20297C10.5 7.87076 10.3772 7.65333 10.2106 7.51028C10.0327 7.35745 9.77648 7.26751 9.5 7.26751C9.22352 7.26751 8.96732 7.35745 8.78938 7.51028C8.62281 7.65333 8.5 7.87076 8.5 8.20297L8.5 8.31847C8.50002 11.2977 8.50003 12.8667 8.36919 13.7408C8.30092 14.1968 8.18711 14.549 7.95775 14.824C7.75006 15.073 7.48021 15.2112 7.25806 15.325L7.17452 15.3679L7.12127 15.3815C5.97885 15.6751 5.16475 15.3937 4.64645 14.861C4.16506 14.3663 4 13.7152 4 13.3415C4 13.0577 4.22386 12.8276 4.5 12.8276C4.77614 12.8276 5 13.0577 5 13.3415C5 13.4816 5.08494 13.8583 5.35355 14.1343C5.58052 14.3676 6.00343 14.5954 6.82672 14.3975C7.05939 14.2768 7.13984 14.2255 7.1985 14.1552C7.25039 14.093 7.32408 13.9635 7.38081 13.5845C7.49827 12.7999 7.5 11.3152 7.5 8.20398C7.5 7.87177 7.37719 7.65333 7.21062 7.51028C7.03268 7.35745 6.77648 7.26751 6.5 7.26751C6.22352 7.26751 5.96732 7.35745 5.78938 7.51028C5.62281 7.65333 5.5 7.87076 5.5 8.20297C5.5 8.48676 5.27614 8.71682 5 8.71682C4.72386 8.71682 4.5 8.48676 4.5 8.20297C4.5 7.88728 4.38129 7.66343 4.1859 7.49223C3.97661 7.30886 3.66243 7.17453 3.28274 7.11289C2.90662 7.05182 2.50092 7.06816 2.14213 7.15232C1.77607 7.23819 1.50463 7.38336 1.35355 7.53861C1.21055 7.68557 0.995495 7.72954 0.808658 7.65C0.621821 7.57047 0.5 7.3831 0.5 7.17527C0.5 4.9518 1.45524 3.26371 2.88463 2.14535C4.3001 1.03788 6.16243 0.5 8 0.5C9.83757 0.5 11.6999 1.03788 13.1154 2.14535C14.5448 3.26371 15.5 4.9518 15.5 7.17527C15.5 7.3831 15.3782 7.57047 15.1913 7.65C15.0045 7.72954 14.7894 7.68557 14.6464 7.53861C14.4954 7.38336 14.2239 7.23819 13.8579 7.15232C13.4991 7.06816 13.0934 7.05182 12.7173 7.11289C12.3376 7.17453 12.0234 7.30886 11.8141 7.49223C11.6187 7.66343 11.5 7.88728 11.5 8.20297C11.5 8.48676 11.2761 8.71682 11 8.71682ZM1.9196 6.15039C1.80124 6.17815 1.68321 6.21215 1.56757 6.2528C1.78314 4.8288 2.49895 3.73875 3.49037 2.96306C4.6999 2.01672 6.33757 1.5277 8 1.5277C9.66243 1.5277 11.3001 2.01672 12.5096 2.96306C13.5011 3.73875 14.2169 4.8288 14.4324 6.2528C14.3168 6.21215 14.1988 6.17815 14.0804 6.15039C13.599 6.03746 13.0648 6.01601 12.5612 6.09777C12.0612 6.17896 11.5557 6.36811 11.1653 6.71017C11.1086 6.75991 11.0546 6.81259 11.0038 6.86816C10.956 6.81637 10.9052 6.76751 10.8519 6.7217C10.4673 6.39142 9.97352 6.23981 9.5 6.23981C9.02648 6.23981 8.53268 6.39142 8.14812 6.7217C8.09619 6.76629 8.04674 6.81377 8 6.86403C7.95326 6.81377 7.90381 6.76629 7.85188 6.7217C7.46732 6.39142 6.97352 6.23981 6.5 6.23981C6.02648 6.23981 5.53268 6.39142 5.14812 6.7217C5.09477 6.76751 5.04404 6.81637 4.99617 6.86816C4.94538 6.81259 4.89144 6.75991 4.83468 6.71017C4.44428 6.36811 3.93884 6.17896 3.43879 6.09777C2.93517 6.01601 2.40099 6.03746 1.9196 6.15039Z\"\n            fill=\"white\"\n          />\n        </svg>\n      </IconWrapper>\n    </DataWrapper>\n  );\n}\n\nconst getBus = async stop => {\n    const result = await fetch(\n      `${window.location.origin}/times/${stop}`\n      ).then(res=>res.json()).catch(()=>({'buses':[]}))\n    return(result);\n}\n\nconst getWeather = async (stop) => {\n  const result = await fetch(\n    `${window.location.origin}/weather/${stop}`\n  ).then((res) => res.json()).catch(()=>({}));\n  return result;\n};\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}